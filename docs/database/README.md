# æ•°æ®åº“è¡¨ç»“æ„æ–‡æ¡£ç´¢å¼•

æœ¬æ–‡æ¡£æä¾› Miji å®¶åº­è®°è´¦ç³»ç»Ÿæ‰€æœ‰æ•°æ®åº“è¡¨çš„å®Œæ•´è¯´æ˜ã€‚

## ğŸ“š æ–‡æ¡£è¯´æ˜

- æ¯å¼ è¡¨éƒ½æœ‰ç‹¬ç«‹çš„æ–‡æ¡£æ–‡ä»¶
- æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»ç»„ç»‡
- åŒ…å«å­—æ®µè¯´æ˜ã€å…³ç³»ã€ç´¢å¼•ã€ä½¿ç”¨ç¤ºä¾‹ç­‰

## ğŸ—‚ï¸ è¡¨åˆ†ç±»

### 1ï¸âƒ£ æ ¸å¿ƒåŠŸèƒ½è¡¨ (Core)

æ ¸å¿ƒä¸šåŠ¡å®ä½“è¡¨ï¼Œç³»ç»Ÿçš„åŸºç¡€æ•°æ®ç»“æ„ã€‚

| è¡¨å | è¯´æ˜ | æ–‡æ¡£é“¾æ¥ |
|------|------|---------|
| `family_ledger` | å®¶åº­è´¦æœ¬è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/family_ledger.md) |
| `family_member` | å®¶åº­æˆå‘˜è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/family_member.md) |
| `account` | è´¦æˆ·è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/account.md) |
| `transactions` | äº¤æ˜“è®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/transactions.md) |
| `currency` | è´§å¸è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/currency.md) |
| `users` | ç”¨æˆ·è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./core/users.md) |

### 2ï¸âƒ£ å…³è”å…³ç³»è¡¨ (Association)

å¤šå¯¹å¤šå…³ç³»çš„ä¸­é—´è¡¨ã€‚

| è¡¨å | è¯´æ˜ | æ–‡æ¡£é“¾æ¥ |
|------|------|---------|
| `family_ledger_member` | è´¦æœ¬-æˆå‘˜å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/family_ledger_member.md) |
| `family_ledger_account` | è´¦æœ¬-è´¦æˆ·å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/family_ledger_account.md) |
| `family_ledger_transaction` | è´¦æœ¬-äº¤æ˜“å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/family_ledger_transaction.md) |
| `todo_project` | å¾…åŠ-é¡¹ç›®å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/todo_project.md) |
| `todo_tag` | å¾…åŠ-æ ‡ç­¾å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/todo_tag.md) |
| `task_dependency` | ä»»åŠ¡ä¾èµ–å…³è”è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./association/task_dependency.md) |

### 3ï¸âƒ£ è´¢åŠ¡ç®¡ç†è¡¨ (Financial)

è´¢åŠ¡ç›¸å…³çš„ä¸šåŠ¡è¡¨ã€‚

| è¡¨å | è¯´æ˜ | æ–‡æ¡£é“¾æ¥ |
|------|------|---------|
| `budget` | é¢„ç®—è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/budget.md) |
| `categories` | åˆ†ç±»è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/categories.md) |
| `sub_categories` | å­åˆ†ç±»è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/sub_categories.md) |
| `split_rules` | åˆ†æ‘Šè§„åˆ™è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/split_rules.md) |
| `split_records` | åˆ†æ‘Šè®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/split_records.md) |
| `debt_relations` | å€ºåŠ¡å…³ç³»è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/debt_relations.md) |
| `settlement_records` | ç»“ç®—è®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/settlement_records.md) |
| `installment_plans` | åˆ†æœŸè®¡åˆ’è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/installment_plans.md) |
| `installment_details` | åˆ†æœŸæ˜ç»†è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./financial/installment_details.md) |

### 4ï¸âƒ£ ä¸šåŠ¡åŠŸèƒ½è¡¨ (Business)

å…¶ä»–ä¸šåŠ¡åŠŸèƒ½æ¨¡å—çš„è¡¨ã€‚

| è¡¨å | è¯´æ˜ | æ–‡æ¡£é“¾æ¥ |
|------|------|---------|
| `todo` | å¾…åŠäº‹é¡¹è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/todo.md) |
| `project` | é¡¹ç›®è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/project.md) |
| `tag` | æ ‡ç­¾è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/tag.md) |
| `reminder` | æé†’è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/reminder.md) |
| `bil_reminder` | è´¦å•æé†’è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/bil_reminder.md) |
| `batch_reminders` | æ‰¹é‡æé†’è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/batch_reminders.md) |
| `period_records` | ç”Ÿç†æœŸè®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_records.md) |
| `period_daily_records` | ç”Ÿç†æœŸæ¯æ—¥è®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_daily_records.md) |
| `period_symptoms` | ç”Ÿç†æœŸç—‡çŠ¶è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_symptoms.md) |
| `period_pms_records` | ç»å‰ç»¼åˆç—‡è®°å½•è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_pms_records.md) |
| `period_pms_symptoms` | ç»å‰ç»¼åˆç—‡ç—‡çŠ¶è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_pms_symptoms.md) |
| `period_settings` | ç”Ÿç†æœŸè®¾ç½®è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./business/period_settings.md) |

### 5ï¸âƒ£ ç³»ç»Ÿé…ç½®è¡¨ (System)

ç³»ç»Ÿçº§é…ç½®å’Œæ—¥å¿—è¡¨ã€‚

| è¡¨å | è¯´æ˜ | æ–‡æ¡£é“¾æ¥ |
|------|------|---------|
| `attachment` | é™„ä»¶è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./system/attachment.md) |
| `notification_settings` | é€šçŸ¥è®¾ç½®è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./system/notification_settings.md) |
| `notification_logs` | é€šçŸ¥æ—¥å¿—è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./system/notification_logs.md) |
| `operation_log` | æ“ä½œæ—¥å¿—è¡¨ | [ğŸ“„ æŸ¥çœ‹è¯¦æƒ…](./system/operation_log.md) |

## ğŸ“Š è¡¨å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  family_ledger  â”‚ (æ ¸å¿ƒ)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                 â”‚
         â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ family_ledger_   â”‚            â”‚ family_ledger_   â”‚
â”‚    member        â”‚            â”‚    account       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
         â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  family_member   â”‚            â”‚     account      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   transactions   â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                    â–¼                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ split_rules  â”‚    â”‚ split_recordsâ”‚    â”‚debt_relationsâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” å¿«é€ŸæŸ¥æ‰¾

### æŒ‰åŠŸèƒ½æŸ¥æ‰¾

- **è´¦æœ¬ç®¡ç†**: `family_ledger`, `family_member`, `family_ledger_member`
- **è´¦æˆ·ç®¡ç†**: `account`, `family_ledger_account`
- **äº¤æ˜“ç®¡ç†**: `transactions`, `family_ledger_transaction`, `categories`, `sub_categories`
- **é¢„ç®—ç®¡ç†**: `budget`
- **åˆ†æ‘Šç»“ç®—**: `split_rules`, `split_records`, `debt_relations`, `settlement_records`
- **åˆ†æœŸä»˜æ¬¾**: `installment_plans`, `installment_details`
- **æé†’åŠŸèƒ½**: `reminder`, `bil_reminder`, `batch_reminders`
- **å¾…åŠç®¡ç†**: `todo`, `project`, `tag`, `todo_project`, `todo_tag`, `task_dependency`
- **ç”Ÿç†æœŸç®¡ç†**: `period_*` ç³»åˆ—è¡¨
- **ç³»ç»ŸåŠŸèƒ½**: `users`, `currency`, `attachment`, `notification_*`, `operation_log`

### æŒ‰å…³ç³»ç±»å‹æŸ¥æ‰¾

- **ä¸»å®ä½“è¡¨**: `family_ledger`, `family_member`, `account`, `transactions`, `users`
- **å…³è”è¡¨**: `family_ledger_member`, `family_ledger_account`, `family_ledger_transaction`
- **é…ç½®è¡¨**: `currency`, `categories`, `sub_categories`, `period_settings`, `notification_settings`
- **è®°å½•è¡¨**: `transactions`, `split_records`, `debt_relations`, `settlement_records`, `operation_log`

## ğŸ“ æ–‡æ¡£çº¦å®š

### å­—æ®µç±»å‹æ˜ å°„

| Rust ç±»å‹ | SQL ç±»å‹ | è¯´æ˜ |
|-----------|---------|------|
| `String` | VARCHAR | å¯å˜é•¿åº¦å­—ç¬¦ä¸² |
| `i32` | INTEGER | 32ä½æ•´æ•° |
| `i64` | BIGINT | 64ä½æ•´æ•° |
| `f64` | DOUBLE | åŒç²¾åº¦æµ®ç‚¹æ•° |
| `bool` | BOOLEAN | å¸ƒå°”å€¼ |
| `Decimal` | DECIMAL | é«˜ç²¾åº¦åè¿›åˆ¶æ•°ï¼ˆè´¢åŠ¡è®¡ç®—ï¼‰ |
| `Json` | JSON | JSON æ•°æ® |
| `DateTimeWithTimeZone` | TIMESTAMP WITH TIME ZONE | å¸¦æ—¶åŒºçš„æ—¶é—´æˆ³ |
| `Option<T>` | NULLABLE | å¯ä¸ºç©ºçš„å­—æ®µ |

### çº¦æŸè¯´æ˜

- **PK (Primary Key)**: ä¸»é”®ï¼Œå”¯ä¸€ä¸”éç©º
- **FK (Foreign Key)**: å¤–é”®ï¼Œå…³è”å…¶ä»–è¡¨
- **NOT NULL**: ä¸å…è®¸ä¸ºç©º
- **NULLABLE**: å…è®¸ä¸ºç©º
- **UNIQUE**: å”¯ä¸€çº¦æŸ
- **CHECK**: æ£€æŸ¥çº¦æŸï¼Œé™åˆ¶å­—æ®µå€¼èŒƒå›´
- **DEFAULT**: é»˜è®¤å€¼

### çº§è”æ“ä½œ

- **RESTRICT**: é™åˆ¶åˆ é™¤ï¼Œå¦‚æœæœ‰å¼•ç”¨åˆ™æ‹’ç»æ“ä½œ
- **CASCADE**: çº§è”æ“ä½œï¼Œè‡ªåŠ¨æ›´æ–°æˆ–åˆ é™¤ç›¸å…³è®°å½•
- **SET NULL**: è®¾ç½®ä¸º NULL
- **NO ACTION**: ä¸æ‰§è¡Œä»»ä½•æ“ä½œ

## ğŸ”§ è¿ç§»æ–‡ä»¶ä½ç½®

æ‰€æœ‰æ•°æ®åº“è¿ç§»æ–‡ä»¶ä½äºï¼š`src-tauri/migration/src/`

è¿ç§»æ–‡ä»¶å‘½åè§„åˆ™ï¼š`mYYYYMMDD_NNNNNN_description.rs`

## ğŸ“š ç›¸å…³èµ„æº

- [SeaORM æ–‡æ¡£](https://www.sea-ql.org/SeaORM/)
- [SQLite æ–‡æ¡£](https://www.sqlite.org/docs.html)
- [æ•°æ®åº“è®¾è®¡æœ€ä½³å®è·µ](../BEST_PRACTICES.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-15  
**ç»´æŠ¤è€…**: Miji Team
