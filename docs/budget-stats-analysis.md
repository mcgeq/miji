# 预算统计分析功能

## 功能概述

基于 `entity/src/budget.rs` 表的字段定义，我们封装了一个完整的预算统计分析界面，集成到现有的前端技术栈中。统计按钮位于预算列表过滤区域的前面，点击后会跳转到专门的统计分析页面。

## 界面布局

### 预算列表页面过滤区域
在预算列表页面的过滤区域，统计按钮位于最前面：

```
[📊 统计分析] [📈 趋势分析] | [全部状态▼] [全部▼] [全部分类▼] | [...] [🔄]
```

- **📊 统计分析按钮**（蓝色）- 跳转到 `/budget-stats` 页面
- **📈 趋势分析按钮**（绿色）- 跳转到 `/budget-trends` 页面
- 其他过滤控件保持原有位置

## 技术实现

### 1. 后端 API 服务
- **文件**: `src/services/money/budgetStats.ts`
- **功能**: 封装预算统计相关的 API 调用
- **主要接口**:
  - `getBudgetOverview()` - 获取预算总览统计
  - `getBudgetStatsByType()` - 按预算类型统计
  - `getBudgetStatsByScope()` - 按预算范围统计
  - `getBudgetTrends()` - 获取预算趋势数据
  - `getBudgetCategoryStats()` - 获取预算分类统计

### 2. 前端状态管理
- **文件**: `src/composables/useBudgetStats.ts`
- **功能**: 提供预算统计的响应式状态管理
- **特性**:
  - 响应式数据状态
  - 筛选条件管理
  - 健康状态计算
  - 错误处理

### 3. 图表组件
- **文件**: `src/features/money/components/BudgetStatsCharts.vue`
- **功能**: 基于 ECharts 的预算统计图表
- **图表类型**:
  - 趋势分析（折线图、柱状图、面积图）
  - 分类分析（饼图、柱状图、雷达图）
  - 概览分析（完成率趋势）

### 4. 统计分析主组件
- **文件**: `src/features/money/components/BudgetStatsAnalysis.vue`
- **功能**: 预算统计分析的完整界面
- **包含**:
  - 统计概览卡片
  - 筛选器面板
  - 图表分析区域

### 5. 集成到预算列表
- **文件**: `src/features/money/components/BudgetList.vue`
- **修改**: 在过滤区域前面添加统计按钮
- **新增按钮**:
  - 📊 统计分析按钮（蓝色）- 跳转到预算统计页面
  - 📈 趋势分析按钮（绿色）- 跳转到预算趋势页面

### 6. 独立页面组件
- **文件**: `src/pages/budget-stats.vue` - 预算统计分析页面
- **文件**: `src/pages/budget-trends.vue` - 预算趋势分析页面
- **功能**: 独立的页面路由，提供完整的统计分析体验

## 基于 Budget 实体的字段分析

根据 `entity/src/budget.rs` 的字段定义，统计分析涵盖以下维度：

### 核心统计指标
- **总预算金额** (`amount`) - 预算总额
- **已使用金额** (`used_amount`, `current_period_used`) - 当前周期使用情况
- **剩余金额** - 计算得出
- **完成率** (`progress`) - 预算执行进度
- **超预算情况** - 超支金额和数量

### 分类维度
- **预算类型** (`budget_type`) - 按类型分组统计
- **预算范围** (`budget_scope_type`) - 按范围类型统计
- **分类范围** (`category_scope`) - 按分类统计
- **账户范围** (`account_scope`) - 按账户统计

### 时间维度
- **周期类型** (`repeat_period_type`) - 重复周期分析
- **开始/结束日期** (`start_date`, `end_date`) - 时间范围分析
- **当前周期** (`current_period_start`) - 当前周期分析

### 状态维度
- **激活状态** (`is_active`) - 活跃预算统计
- **提醒设置** (`alert_enabled`, `alert_threshold`) - 提醒相关统计
- **优先级** (`priority`) - 按优先级分析

## 使用方法

### 1. 访问统计分析
在预算列表页面的过滤区域，点击：
- 📊 **统计分析** 按钮 - 跳转到 `/budget-stats` 页面，查看详细统计面板
- 📈 **趋势分析** 按钮 - 跳转到 `/budget-trends` 页面，查看趋势图表

### 2. 统计分析页面 (`/budget-stats`)
提供完整的预算统计分析功能：
- **统计概览卡片** - 显示总预算、已使用、剩余金额、完成率等关键指标
- **筛选器面板** - 可以设置货币、日期、时间范围等筛选条件
- **图表分析区域** - 多种图表类型和样式选择

### 3. 趋势分析页面 (`/budget-trends`)
专注于预算趋势分析：
- **趋势图表** - 折线图、柱状图、面积图等多种展示方式
- **分类分析** - 饼图、柱状图、雷达图等分类统计
- **概览分析** - 完成率趋势和预警线显示

## 界面特性

### 响应式设计
- 支持桌面端和移动端
- 自适应布局调整
- 触摸友好的交互

### 视觉设计
- 现代化的卡片式布局
- 清晰的状态指示（健康/警告/超支）
- 丰富的图表类型选择
- 直观的图标和颜色编码

### 用户体验
- 一键切换统计面板
- 实时数据更新
- 错误状态处理
- 加载状态提示

## 扩展性

该统计分析系统具有良好的扩展性：

1. **新增统计维度** - 可以轻松添加新的统计指标
2. **自定义图表** - 支持添加更多图表类型
3. **数据导出** - 可以扩展数据导出功能
4. **实时更新** - 支持 WebSocket 实时数据推送
5. **多语言支持** - 完整的国际化支持

## 技术栈

- **前端框架**: Vue 3 + TypeScript
- **状态管理**: Pinia
- **图表库**: ECharts + vue-echarts
- **UI 组件**: 自定义组件 + Lucide 图标
- **样式**: CSS3 + 响应式设计
- **国际化**: Vue I18n
